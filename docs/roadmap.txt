SPQR II
=======

Player controls Rome
Game is turn-based
Map is region based


Turn Sequence
-------------

Player deals with cards
Player decides the budget spend
Player performs a series of campaigns
Player can then move troops long range
Player spends one more card
Next emperor is chosen
Year moves on 20 years. Loop back to start


Overview
--------

Starting in 200 BC, you have 2 consuls and a small number of regions.

All regions have:
	3 places a unit can be
	A possible city
	Paths between the places and other regions

Each consul can conduct a certain (low) number of campaigns
A campaign is conducted this way:
	* A friendly region is chosen, and the consul moved there
	* First, you may Support:
		- The consul may choose to move ONE unit from ONE region from anywhere on the board to their region
	* Then you may Prepare:
        - **A loop starts from here**
		- The consul can move, by one region (which may be >1 node), all the units in this region and all controlled adjacent ones
	
	* And then you may Attack:
		- After this move, the player can choose any controlled region unit to attack a non-controlled region

	With tougher enemies, they can also support and prepare.
	Enemies may move after all of your moves.
	You may or may not see this.

	* On attacking, we add another element: the purpose of the invade. The player chooses a goal:
		1: Raid: Avoid combat and leave after stealing money
		2: Destroy enemy forces: Find the enemy forces and engage them, destroy them, grab any loot and go home (more loot than 1)
		3: Invade: Capture the region and the city (loot: not that much, you want to keep not destroy!)
		4: Sack: Capture the region and the city, steal everything, burn it all, and go home (this will gain a lot more money than 2)

	Enemy choices (and the player when you are invaded) and outcomes for 1-4 above:

		1: (Raid) Choice: Attack / Don't Attack
			First leads to battle on random number (i.e., you want to fight)
				* Enemy may simply run away at this point - option is given to player raiding, fails on random number
				* If failed runaway, battle engaged
				* Game: Choose a unit in the region to attack. If they run, you move and they move away
						If they do not move away (or unlucky), battle ensues
						Smart raider send 2 units in and retreat when threatened
			Second (or failed check) leads to losing money and enemy leaving
		2: (Destroy) Engage, or choose not to on a check
			If you try to engage, there is a guarenteed battle
			Not engage, needs a random check: fail is the battle
			Pass is move to a friendly region or battle if no move avaliable
			Game: Either move the unit to a different node or don't
				  If you don't, there must be a battle
				  If you do move, there's still a chance you have to fight
		3: (Invade) Engage or not as above.
			If you do not engage (checked), the attackers have a chance to attack the city
				If they win, they have the city. You may attack the city or retreat to another region.
				If they lose, you may attack on their retreat
			If you engage (or failed check), there is a battle. If the attackers win, they move on to attack the city.
		4: (Sack) Plays out as 3, except you have the extra option to withdraw:
			The attackers attack the city.
			If they lose, they go home
			If they win, they steal everything and go home
			You may not attack if they lose the city battle
			There is no check on a random meeting (so there's no chance you'll lose the army if the city isn't worth it)
            Game: Move all units in the region to another region
                - I suppose the other region could be non-friendly, like the Goths against Valens.


	* Combat is decided per unit vs unit, and the player can see the results of the 1st region attack before deciding on others
	* For combat, the results could be:
        * Units move back to a unoccupied or friendly node. Nobody takes damage.
		* Units retreat to previous node. Both sides take some form of damage.
		* Units push into the territory but enemy units remain
		* No enemy units remain but the city is not taken
        * No enemy units remain and any city is captured
	* We repeat from "The consul can move"
    ** END LOOP! **

	* A certain amount of "fatigue" builds up every cycle, and units start to lose effeciency fairly quickly (on both sides)
		* The loop "The consul can move" might be thought of a campaign year passing. Depends on how many times that happens
        * Possible: Autumn arrives. Continuing will cost in GDP as crops are not brought in
                    Winter arrives. All units remain where they. 
                        Unsupported units will die, supported units in unconqured regions (unless a city) cost some factor more
	* It is important to note the AI should be able to play between these moves (i.e., defend if obvious, attack if obvious, keep it simple)
	* A player can choose to "wait" between campaigns so they can react to enemy events
	* If they do, the wait costs a campaign. Emperors that have average or better strategy can wait once for free if they only have 1 campaign left.
        - The chance of an event after a wait is very low
Once all campaigns are done, maybe the enemy chooses now to attack
If all campaigns are done, the player may choose to campaign an extra time at some expense
	* The expense is borne by the following emperor, since it is funded by money borrowed or spent during their reign
    * And by "some expense" it should also reduce GDP as it represents a massive military spend
    * Essentially, it's free at the point of access, but possibly very damaging long term
Now cultural and city growth is done (TODO)
    - Need to express the cultural growth, not just as a number
    - So it needs something on the map, since that's what you always look at
        - Idea #1: (very hard): Music appears, and it gets more complex
        - Idea #2: (not too hard): Expressed in events, although that lacks the map aspect
        - Idea #3: (lots of assets): The images shown on the UI upgrade themselves
            - not the buttons, the event images, the pause screen image, that sort of thing
        - Idea #4: (really hard): Writers / Artists are shown doing jobs on the map


At some point the "Empire" card is played, to remove the Republic
This always give a civil war
In a civil war:
	You must beat the other rival(s)
	Unlimited campaigns but success begats success and you should steamroll (or lose fast)
	A civil war can happen at any time in the turn, but is most common at the start. The turn sequence should go:
		* An emperor is chosen in the normal way / The emperor is challenged
		* Civil war is declared
		* All those that could have been chosen become claimants
		* Player now chooses who to be
		* A non-stop campaign is held until there is a winner
		* It is more likely that a Roman army will "turn" rather than be defeated heavily
			- Thus, battles will likely have less casualties
		* The player now continues as the winner - which may be someone different

Game is played as expected, except:
	The goal is to:
		A: Destroy all rivals
		B: Go to Rome
	For all participants:
		You can only rarely recruit new army members (if you beat an opponent)
		All Rome regions are friendly, including Rome
		Moving to Rome gives a chance your rivals give up, especially if your army is much bigger
			* By "give up" we likely mean "killed by the soldiers"
		No challenger will want to not accept a fight, typically they all march to Rome ASAP

In the Empire:
	On the first emperors turn, all cards removed and replaced with all good cards
	Only 1 emperor, and not 2 consuls, so war is harder
		- A Later card allows an "East" and a "West" emperor, of course
	Tax revenue goes up - more to play with
	Cities increase tax revenue even more
	A card is needed to found a city, rather than randomly in the Republic


Changing Emperors
-----------------

At the end of a turn, you may choose the next emperor / senators.
3 - 4 candidates are given (4 - 5 if senators, or split empire)
They are chosen as:
	A family member (if good % chance is met)
		Competent leaders - or on a random event - can get to choose this person
		With your vote
	Random others
Each candidate has a set of traits, varying from terrible to fantastic, some neutral.
Those traits will affect outcomes like:
	- Battles
	- Culture
	- Money
	- Romanisation
	- Maybe adds some random events
The outcome is not always what the player wants. They have a vote (maybe ++). The other votes are based on traits:
	+ for popular / loved
	- for unloved / hated
	+ for ambitious
	+ for family connections
	- for peaceful
	+ for bribes
The only real extra gameplay mechanic is the bribes.
	Low level bribes result in the loss of money when they become consuls.
	With Emperors, slowly the donative to the troops will become larger and larger.
	If a candidate is winning with their donative, you may choose to pay more for your candidate
		- A key method of crippling Rome is to leave it cashless as a succession
		  of Emperors spend all the money becoming emperor.
In general, the player should usually be able to choose what they want
	- The flipside is that they often only have a set of bad choices.
		- A key method of crippling Rome is to only have terrible choices

If an emperor is selected who is truly awful (as decided by a set of metrics):
	- The game immediatly switches to a campaign
	- The Emperor starts in Rome and must defeat the other candidate
	- If the Emperor loses, they are replaced by the victor
	- This will reduce Roman troops if there are battles, and will cost money
	- If the emperor wins, the donative is paid; otherwise half is paid (or rather, lost)
	- The emperor can never campaign before enemies
		- Another key method of crippling Rome is starting every turn with a civil war

If an emperor is truly truly awful:
	- They are murdered by the people of Rome on turn start
	- You may choose a senator or general as emperor; likely they will be good
	- 80% of the donative will be returned

When the empire splits to East / West (card based):
	- 2 Emperors are chosen
	- Unlike senators, these emperors act in their own area
	- Your votes are lopsided:
		- You may allocate votes to either East or West, but only one side.
			* I.e. if you have 3 votes (cards or skill) they cannot be split
			* To further detail, you can vote for ONE person only
		- Your family member must be on the side you voted for
			* I.e. you must vote for the region your family member is in
		- This means one choice will be essentially random
		- Civil wars will be contained in their own areas (east or west)

Emperors can change in a turn due to civil war
	- The "total campaigns" of any emperor is against ALL the campaigns of the turn
	- So if you start with 4 and have 2 canpaigns, and then we change to an emperor who starts with 3 campaigns, you only have 1 campaign left
	- The campaign for the civil war is a free campaign on both sides
	- Obviously a war with yourself is twice as costly as a normal war and damages only your territory
	- A "decent" (to be defined) Emperor may have the option to kill themselves, avoiding bloodshed


Hiding Information
------------------

Not all systems are transparent.
There are hidden stats that are never exposed, but sometimes expressed in player messages.
Maybe the stats are exposed and accumulation obscure, or the other way around
These are:
	Culture
		Writing			- Should be accumulative, starts at 0 and cards + cities + peace add to this (easy to get)
		Art 			- Should be accumulative, starts at 0 and cards + cities + peace add to this (hard to get)
	Natural World
		Engineering 	- Should be accumulative, starts at 0 and cards + cities + peace add to this (easy to get)
		Science 		- Should be accumulative, starts at 0 and cards + cities + peace add to this (very hard to get)
	Religion
		Christianity 	- Starts at zero and can go up and down (but not below zero)
			This stat triggers the "Christian Emperor" card
			Christianity is double-edged:
				* It means less tax revenue overall
				* Less romanisation
				* The first Christian emperor has more money (raids temples) and has an army with high morale
		Roman Gods		- Starts at some value and can fluctuate (especially if you add a new region)
			- Whats the point of this stat?
These stats effect your score at the end, so they are important.
To get the best scores should be hard, so no shame should be attached to low scores in one area.


Enemies
-------
	Enemy AI must have characteristics
		* I.e., barbarians act different in some way to Persians
			- maybe as simple as one raids, one invades
	They must move their units, build things, expand and decline like the player
		- Kept pretty simple, and mainly driven by progress
	Their leaders are like the player in the way they attack
	Although they don't really have cards, they may act like they do due to random events
	AI is fairly simple
		* Aggressive AI will attack if it looks possible, or raid if barbarian and defenses are low
		* Expansionist will do the same but stick around
		* Raiders will raid, and avoid combat (a city helps here)
		* Neutral AI will largly avoid attacking
		* Friendly AI (rare) is controlled by the player
		* They will generally ask for a truce if needed rather than risk destruction
	The troops:
		There should NOT be a kind of scissors, paper rock here, we do not want strategy everywhere
		As history progresses, horse mounted troops improve - by 400 AD they are essential
			* Change could be card based


Regions
-------

Each region has:
	A major city
	A culture stat (gives culture)
	A money stat (gives money)
	A manpower stat
	A "loyalty to the emperor" stat (?)
	An indicator of basic terrain type


Troops
------

	Troops have an attack and defence
	Fights are determined by:
		* Ratio of troops
		* Attack vs defence rating
		* Generals ratings
		* Luck

Cards:
------
	Player is given 6 cards at start of game
	They are divided into "good", "neutral" and "bad" cards which are mixed
	Two must be played at the start of a turn, and another at the end
		* Player gets 1 card, then must play 2. Then they get another card
		* After playing cards, player may discard any good or neutral cards.
		* For every 2 cards they discard (1 of which must be a good card), they may also discard 1 bad card
		* Thats about 90 "natural" cards per game, they should and will be important

	After playing, another is picked up
	Card effects can change gameplay, eg:
		* Card: Leader has 1 extra campaign
	Or meta-gameplay
		* Card: When played, gain 2 random good cards which are played instantly
		* Card: Some effect + "this card may not be discarded"
	Or force game changes:
		* Card: Roman changes from Republic to Empire.
	Cards can have options, so that they may be multi-purpose
		* Card: Either event may happen:
			* Tacitus writes a famous history of Rome
			* You have +1 campaigns
		* When played, raises an event


Events:
-------

Events can trigger at any time.
They are a simple question that requires an answer.
Examples:
	Mistreated nobles want to claim the money confiscated by the previous emperor.
		A: Reject B: Pay 50% C: Pay all

	Enemy offers 20,000 talents of silver to withdraw from a region
		A: Reject B: Accept

On the programming side, it's like raising a simple dialog.
This means there needs to be some mechanism for this.


What do Roads do?
-----------------

Roads need a purpose. Ideas:
	* Roads faciltate a trade bonus
	* Troops move quicker, although you may not really notice that
	* If the troops moved under the prepare phase all use roads, the enemy will have no prepare phase, unless they also have roads.
	* In the support phase, you may move 2 units if their move is all along roads.
	* Retreat is a lot easier with roads
	* Increased romanization if connected to Rome
	* Roads add to the general score
	* They are expensive, best added by general romanization (but perhaps by then the effects are weakened?)
	* Most regions should have roads by 200, and the more far flung by 300 AD


What do Boats do?
-----------------

Boats / Ports need a purpose. Ideas:
	* Ports facilitate goods getting to Rome
	* Ships prevent piracy
	* Troops move quicker / easier


We need:
--------

	The map, split into regions
	The cities / ports and other things to be drawn on the map
	Images for all the unit types
	Stats and names for all the regions
	Some way for the AI to work


Milestone #1:
-------------

	Get a drawn map on screen.
	Allow map to be scrolled / moved around with cursor and mouse
	Click a region and see stats on sidebar

	Details (started writing:7th August 2021 coding: 7th August 2021):
		* Cursor keys move smoothly ✓. Should be fast ✓ and fluid
		* Middle mouse grab overules keys and also moves smoothly
		* Click detection by lookup on texture ✓
		* MapRegion is a class instanced from json data ✓, it is stored in a meta "engine" class
		* Stats are UI, make it a simple text box and get the sizing right for now ✓
		* The UI is going to need a dropshadow, and insetting a little ✓
		* Not clicking a region (i.e., the sea) should do nothing ✓

Milestone #2:
-------------
	Add cities ✓ and roads to the map (some artwork needed here)
	GUI overlay shows current year and a person (the emperor) - get the layout right

	Details (started writing:7th August 2021)
		* Not all regions need roads between them.
		* Cities should be easy enough. Like an icon probably ✓
		* They'll need to be pulled from json again ✓
		* The stats are likely to be:
			- Size
		* When clicking a city or region, the stat panel should be the same size and display both sets of stats ✓
		* ESC brings up a menu (this is a ton of work, it means "decide the UI look and do it")

Milestone #3:
-------------
	Add units
	Allow movement
	Turn: Move units -> click turn button

	Details (started writing:7th August 2021)
		* Needs some easy way to read a display of strength on the map
		* Allow a unit to move ONCE. 1 move away with no road, and 2 with a road
		* You need to display the move options AND calculate them. A ton of work!

Milestone #4:
-------------
	Add front end.
	Enable save / load
	Solve and set any resolution / windowing issues

	Details (started writing:7th August 2021)
		* Mainly this is switching scenes and data manipulation
		* Only allow a set number of saves
		* Add scenarios (a save with some flavour text)
		* SPQR is about old shit. No need to jazz the UI up, just make it work and easy to use

Milestone #5:
-------------
	Add cards
	Always have X cards (a card can give you more.. or less)
	You must play a card at the start of each turn
	You are given a random one after playing

	Details (started writing:7th August 2021)
		* Make the cards simple - just text!
		* Player will need a way to see the cards - add a button and some bar showing current empire info
		* There really should not be a lot of "screens with menus", the game should aim to present choices, not endless build options for endless cities
			- By which I mean, I don't want the player micro-managing. They need to play the game turn by turn based on the options they have.

Milestone #6:
-------------
	Add select emperor
	At the end of a turn, the new emperor is selected

	Details (started writing:7th August 2021)
		* Apart from the overlay, this is more or less graphical for now

Milestone #7:
------------
	Add a way to spend money
	This means having a budget screen
	Bad emperors might prevent access to this screen!
	Improve buildings, religion, imports, military, food

	Details (started writing:7th August 2021)
		* Rather than a screen that is always viewable, make it a flow
		* Will see after getting the emperor (and before being able to move)
		* Will see after combat - correct your mistakes
		* Combat is blocked in this turn - you'll need to add to the "next turn" button

Milestone #8:
-------------
	Make the cards and emperor stat changes work
	Show "people", generals, emperor or consuls on side panel
	Restrict attacks to where these people are

Milestone #9:
-------------
	Add combat, and keep it simple!
	It should be definitive more than attritional
	This will need some animations

Milestone #10:
--------------
	Go back and improve steps #1 -> #9 and finalise each step.
